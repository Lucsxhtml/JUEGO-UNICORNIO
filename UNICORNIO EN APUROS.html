<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unicornio en Apuros: ¡El Gato está Cerca!</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0e5ff;
            font-family: Arial, sans-serif;
        }
        #gameArea {
            position: relative;
            width: 400px;
            height: 400px;
            border: 2px solid #000;
            overflow: hidden;
            background-color: #d8b7eb;
        }
        .unicorn, .cat {
            position: absolute;
            width: 40px;
            height: 40px;
        }
        .unicorn {
            background: url('https://png.pngtree.com/png-vector/20240705/ourmid/pngtree-unicorn-cartoon-clipart-vector-png-image_12983571.png') no-repeat center center;
            background-size: cover;
        }
        .cat {
            background: url('https://images.vexels.com/content/232173/preview/anti-valentine-angry-cat-cartoon-fa6318.png') no-repeat center center;
            background-size: cover;
        }
        .star {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        #restartBtn {
            display: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Unicornio en Apuros: ¡El Gato está Cerca!</h1>
    <div id="gameArea">
        <div id="unicorn" class="unicorn"></div>
        <div id="cat" class="cat"></div>
    </div>
    <button id="restartBtn" onclick="startGame()">Volver a jugar</button>
    <p id="score">Puntos: 0</p>

    <script>
        let unicornElement = document.getElementById('unicorn');
        let catElement = document.getElementById('cat');
        let scoreElement = document.getElementById('score');
        let restartBtn = document.getElementById('restartBtn');
        let gameArea = document.getElementById('gameArea');
        let score = 0;
        let gameInterval;

        function startGame() {
            score = 0;
            unicornElement.style.top = '180px';
            unicornElement.style.left = '180px';
            catElement.style.top = '0px';
            catElement.style.left = '0px';
            scoreElement.innerText = "Puntos: " + score;
            restartBtn.style.display = 'none';
            gameInterval = setInterval(moveCat, 500);
            document.addEventListener('keydown', moveUnicorn);
            createStars();
        }

        function moveUnicorn(event) {
            const unicornStyle = window.getComputedStyle(unicornElement);
            let top = parseInt(unicornStyle.top);
            let left = parseInt(unicornStyle.left);

            switch(event.key) {
                case 'w': top -= 10; break;
                case 's': top += 10; break;
                case 'a': left -= 10; break;
                case 'd': left += 10; break;
            }

            if (top >= 0 && top <= 360) unicornElement.style.top = top + 'px';
            if (left >= 0 && left <= 360) unicornElement.style.left = left + 'px';

            checkCollision();
            checkStarCollision();
        }

        function moveCat() {
            const unicornStyle = window.getComputedStyle(unicornElement);
            const catStyle = window.getComputedStyle(catElement);
            let unicornTop = parseInt(unicornStyle.top);
            let unicornLeft = parseInt(unicornStyle.left);
            let catTop = parseInt(catStyle.top);
            let catLeft = parseInt(catStyle.left);

            // Aumentar la velocidad del gato
            catTop += Math.sign(unicornTop - catTop) * 8; // Cambiar 5 a 8 para mayor velocidad
            catLeft += Math.sign(unicornLeft - catLeft) * 8; // Cambiar 5 a 8 para mayor velocidad

            if (catTop < 0) catTop = 0;
            if (catTop > 360) catTop = 360;
            if (catLeft < 0) catLeft = 0;
            if (catLeft > 360) catLeft = 360;

            catElement.style.top = catTop + 'px';
            catElement.style.left = catLeft + 'px';

            checkCollision();
        }

        function checkCollision() {
            const unicornRect = unicornElement.getBoundingClientRect();
            const catRect = catElement.getBoundingClientRect();

            if (
                unicornRect.left < catRect.right &&
                unicornRect.right > catRect.left &&
                unicornRect.top < catRect.bottom &&
                unicornRect.bottom > catRect.top
            ) {
                endGame(false);
            }
        }

        function createStars() {
            for (let i = 0; i < 20; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                star.style.top = Math.random() * 390 + 'px';
                star.style.left = Math.random() * 390 + 'px';
                star.style.backgroundColor = getRandomColor();
                gameArea.appendChild(star);
            }
        }

        function checkStarCollision() {
            const unicornRect = unicornElement.getBoundingClientRect();
            const stars = document.querySelectorAll('.star');

            stars.forEach(star => {
                const starRect = star.getBoundingClientRect();
                if (
                    unicornRect.left < starRect.right &&
                    unicornRect.right > starRect.left &&
                    unicornRect.top < starRect.bottom &&
                    unicornRect.bottom > starRect.top
                ) {
                    score++;
                    scoreElement.innerText = "Puntos: " + score;
                    star.remove();
                    if (score >= 20) {
                        endGame(true);
                    }
                }
            });
        }

        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        function endGame(won) {
            clearInterval(gameInterval);
            document.removeEventListener('keydown', moveUnicorn);
            if (won) {
                alert("¡Ganaste!");
            } else {
                alert("¡Te atrapó el gato!");
            }
            restartBtn.style.display = 'block';
        }

        startGame();
    </script>
</body>
</html>